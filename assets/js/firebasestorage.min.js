const storageRef = firebase.storage().ref();

document.querySelector('.my-pond').addEventListener('change', handleFileUploadChange);
document.querySelector('.my-pond').addEventListener('change', handleFileUploadSubmit);

let selectedFile;
function handleFileUploadChange(e) {
    selectedFile = e.target.files[0];
}

function handleFileUploadSubmit(e) {
    const uploadTask = storageRef.child(`Quotes/${selectedFile.name}`).put(selectedFile); //create a child directory called images, and place the file inside this directory
    uploadTask.on('state_changed', (snapshot) => {
        // Observe state change events such as progress, pause, and resume
    }, (error) => {
        // Handle unsuccessful uploads
        alert("You must log in to upload files. Delete this file and try again after logging in with Google or Email.");
    }, () => {
        // Do something once upload is complete
        console.log('File successfully uploaded');
            uploadTask.snapshot.ref.getDownloadURL().then(function (downloadURL) {
                    document.getElementById('hiddenlink').value = downloadURL.toString();
            });
    });
}

function googleLogin() {
    var provider = new firebase.auth.GoogleAuthProvider();

    firebase.auth().signInWithPopup(provider)

        .then(result => {
            const user = result.user;
            document.getElementById('Pin-FullName').value = user.displayName.toString();
            document.getElementById('Pin-email').value = user.email.toString();
            document.getElementById('loginmethod').style.display = "none";
            $('.pinContact').css({
                'display': 'block'
            });
            console.log('Successful google login.')
        })
        .catch(console.log)
}



function checkRadios(){
    if (document.getElementById('size225').checked) {
        $('#velvetbagcost').text('Velvet Bag: $0.80')
        $('#velvetcasecost').text('Velvet Case: $4.25')
        $('#acryliccasecost').text('Acrylic Case: $1.25')
    }
    else if (document.getElementById('size250').checked) {
        $('#velvetbagcost').text('Velvet Bag: $1.05')
        $('#velvetcasecost').text('Velvet Case: $4.50')
        $('#acryliccasecost').text('Acrylic Case: $1.50')

    }
    else if (document.getElementById('size275').checked) {
        $('#velvetbagcost').text('Velvet Bag: $1.30')
        $('#velvetcasecost').text('Velvet Case: $4.75')
        $('#acryliccasecost').text('Acrylic Case: $1.75')
    }
    else if (document.getElementById('size300').checked) {
        $('#velvetbagcost').text('Velvet Bag: $1.55')
        $('#velvetcasecost').text('Velvet Case: $5.00')
        $('#acryliccasecost').text('Acrylic Case: $2.00')
    }
    else {
        $('#velvetbagcost').text('Velvet Bag: $0.55')
        $('#velvetcasecost').text('Velvet Case: $4.00')
        $('#acryliccasecost').text('Acrylic Case: $1.00')
    }
    
}

function checkRadiosp() {
    if (document.getElementById('size200p').checked) {
        $('#velvetbagcostp').text('Velvet Bag: $0.80')
        $('#velvetcasecostp').text('Velvet Case: $4.25')
        $('#acryliccasecostp').text('Acrylic Case: $1.25')
    }
    else if (document.getElementById('size225p').checked) {
        $('#velvetbagcostp').text('Velvet Bag: $1.05')
        $('#velvetcasecostp').text('Velvet Case: $4.50')
        $('#acryliccasecostp').text('Acrylic Case: $1.50')
    } else if (document.getElementById('size250p').checked) {
        $('#velvetbagcostp').text('Velvet Bag: $1.30')
        $('#velvetcasecostp').text('Velvet Case: $4.75')
        $('#acryliccasecostp').text('Acrylic Case: $1.75')
    }
    else {
        $('#velvetbagcostp').text('Velvet Bag: $0.55')
        $('#velvetcasecostp').text('Velvet Case: $4.00')
        $('#acryliccasecostp').text('Acrylic Case: $1.00')
    }

}

function anonLogin() {
    firebase.auth().signInAnonymously().catch(function (error) {
        // Handle Errors here.
        var errorCode = error.code;
        var errorMessage = error.message;
        // ...
    });
    console.log("Successful email login.")
    document.getElementById('loginmethod').style.display = "none";
   
    $('.pinContact').css({
        'display': 'block'
    });

}

firebase.auth().onAuthStateChanged(function (user) {
    if (user) {
        // User is signed in.
        var isAnonymous = user.isAnonymous;
        var uid = user.uid;
        var name = user.displayName.toString();
      
        console.log('User is logged in.' )
        // ...
    } else {
        console.log('User is not logged in.');
        // ...
    }
    // ...
});
